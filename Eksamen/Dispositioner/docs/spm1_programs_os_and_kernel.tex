\section{Programs in relation to the OS and the kernel}

\subsection{Sub topics}

\begin{itemize}
	\item Processes and threads.
	\item Threading model.
	\item Process anatomy.
	\item Virtual memory.
	\item Threads being executed on CPU, the associated scheduler and cache.
\end{itemize}

\subsection{Curriculum}

\begin{itemize}
	\item Slides "Intro to OS's".
	\item Slides "Parallel programs, processes and threads".
	\item OLA: "Anatomy of a program in memory", Gustavo Duarte.
	\item OLA: "The free lunch is over".
	\item OLA: "Virtual memory", pages 131-141.
	\item OLA: " Introduction to operating systems".
	\item OLA: "Multithreading".
	\item Kerrisk: Ch. 3-3.4 - System programming concepts.
	\item Kerrisk: Ch. 29 - Threads: Introduction.
\end{itemize}

\subsection{Exercises}

\begin{itemize}
	\item Posix Threads.
\end{itemize}

\subsection{Processes and threads}
\begin{itemize}
	\item En \textbf{process} er en instans af et program, som eksekveres.
	\item En \textbf{thread} er en del af eksekveringen, alle processer har mindst én thread.
\end{itemize}

\subsubsection*{Processes}
\begin{itemize}
	\item Har hver sit memory space.
	\item Process A kan ikke skrive i Process B's hukommelse.
	\item Kan kun kommunikere gennem IPC\footnote{Inter-Process Communication, mekanismer kontrolleret af OS.}
	\item Kan skabe andre processer som kan eksekvere det samme eller andre programmer.
\end{itemize}

\subsubsection*{Threads}
\begin{itemize}
	\item Alle tråde i en process dele hukommelse på heap'en.
	\item Alle tråde har hver sin stack og \todo{hvad vil program counter sige?}program counter.
	\item Kan fucke med hinanden
	\begin{itemize}
		\item Skal passe på at man ikke sletter de øvrige trådes data.
	\end{itemize}
\end{itemize}

\subsection{Threading model}
Der findes tre forskellige modeller:

\begin{itemize}
	\item User level threading.
	\item Kernel level threading.
	\item Hybrid level threading.
\end{itemize}

\subsubsection*{User level threading}
\begin{itemize}
	\item Simpel implementering, ingen kernel support for threads.
	\item Ekstremt hurtig thread kontekst skift (\todo{woot?}ikke brug for kernel handling).
	\item Ikke muligt at håndtere flere kerner\todo{hvorfor?}.
\end{itemize}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.7\linewidth]{figs/userthreads}
	\caption{User level threading illusteret.}
	\label{fig:userthreads}
\end{figure}

\subsubsection*{Kernel level threading}
\begin{itemize}
	\item Brug for thead bevisthed i kernel.
	\item Mapper direkte til threads som \textit{scheduleren} kan kontrollere.
	\item Effektiv brug af flere kerner.
\end{itemize}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.7\linewidth]{figs/kernelthreads}
	\caption{Kernel level threading illusteret.}
	\label{fig:kernelthreads}
\end{figure}

\subsubsection*{Hybrid level threading}
\begin{itemize}
	\item Komplex implementering\todo{why?}.
	\item Kræver god coordination mellem userspace og kernelspace scheduleren - ellers ikke optimal brug af resources.
\end{itemize}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.7\linewidth]{figs/hybridthreads}
	\caption{Hybrid level threading illusteret.}
	\label{fig:hybridthreads}
\end{figure}

\subsection{Process anatomy}
\subsection{Virtual memory}
\subsection{Threads being executed on CPU, associated scheduler and cache}







